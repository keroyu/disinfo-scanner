# 管理員使用指南

**DISINFO_SCANNER 會員管理系統**
**版本**: 1.0.0
**最後更新**: 2025-11-23

## 目錄

1. [管理員登入](#管理員登入)
2. [使用者管理](#使用者管理)
3. [角色變更](#角色變更)
4. [身份驗證審核](#身份驗證審核)
5. [報表與分析](#報表與分析)
6. [稽核日誌](#稽核日誌)
7. [安全性最佳實務](#安全性最佳實務)
8. [常見問題](#常見問題)

---

## 管理員登入

### 預設管理員帳號

- **電子郵件**: themustbig@gmail.com
- **預設密碼**: 2025Nov20
- **角色**: 管理員 (Administrator)

### 登入步驟

1. 前往登入頁面: `/login`
2. 輸入管理員電子郵件和密碼
3. 點擊「登入」按鈕
4. 成功登入後,您將被導向管理員儀表板

### 安全建議

⚠️ **重要**: 首次登入後,請立即變更預設密碼!

1. 點擊右上角使用者選單
2. 選擇「設定」
3. 在「密碼管理」區塊變更密碼
4. 新密碼必須包含:
   - 至少 8 個字元
   - 1 個大寫字母
   - 1 個小寫字母
   - 1 個數字
   - 1 個特殊字元

---

## 使用者管理

### 檢視使用者列表

1. 從管理員儀表板,點擊「使用者管理」
2. 您將看到所有註冊使用者的列表,包含:
   - 使用者 ID
   - 電子郵件
   - 目前角色
   - 電子郵件驗證狀態
   - 註冊日期
   - 最後登入時間

### 搜尋與篩選

使用者列表頁面提供強大的搜尋與篩選功能:

- **搜尋**: 在搜尋框中輸入電子郵件或使用者 ID
- **角色篩選**: 選擇特定角色以僅顯示該角色的使用者
- **驗證狀態篩選**: 篩選已驗證/未驗證的使用者
- **日期範圍**: 依註冊日期篩選

### 檢視使用者詳情

1. 在使用者列表中,點擊使用者的電子郵件或「檢視」按鈕
2. 您將看到使用者的完整資訊:
   - 基本資訊 (電子郵件、註冊日期)
   - 角色與權限
   - API 配額使用情況 (適用於高級會員)
   - 身份驗證狀態
   - 稽核日誌 (最近的活動)

---

## 角色變更

### 可用角色

系統支援 5 種使用者角色:

1. **訪客** (Visitor) - 未註冊使用者
2. **一般會員** (Regular Member) - 基本權限
3. **高級會員** (Premium Member) - 進階功能 + API 配額
4. **網站編輯** (Website Editor) - 完整前端權限
5. **管理員** (Administrator) - 無限制權限

### 變更使用者角色

#### 步驟

1. 前往「使用者管理」頁面
2. 找到要變更角色的使用者
3. 點擊「編輯」按鈕
4. 在「角色」下拉選單中選擇新角色
5. 點擊「儲存變更」按鈕
6. 系統會顯示確認訊息

#### 權限矩陣

| 功能 | 訪客 | 一般會員 | 高級會員 | 網站編輯 | 管理員 |
|------|------|----------|----------|----------|--------|
| 檢視首頁 | ✓ | ✓ | ✓ | ✓ | ✓ |
| 檢視影片列表 | ✓ | ✓ | ✓ | ✓ | ✓ |
| 檢視頻道列表 | ✗ | ✓ | ✓ | ✓ | ✓ |
| 檢視留言列表 | ✗ | ✓ | ✓ | ✓ | ✓ |
| 影片搜尋 | ✗ | ✗ | ✓ | ✓ | ✓ |
| 留言搜尋 | ✗ | ✗ | ✓ | ✓ | ✓ |
| U-API 匯入 | ✗ | ✓ | ✓ | ✓ | ✓ |
| 官方 API 匯入 | ✗ | ✗ | ✓ (10/月) | ✓ (10/月) | ✓ (無限制) |
| 影片更新 | ✗ | ✓ * | ✓ * | ✓ * | ✓ |
| 管理使用者 | ✗ | ✗ | ✗ | ✗ | ✓ |

\* 需設定 YouTube API 金鑰

#### 重要限制

⚠️ **自我權限保護**: 管理員無法變更自己的角色!

如果您嘗試變更自己的角色,系統會顯示警告訊息:

> ⚠️ 無法變更自己的權限等級,請聯繫其他管理員協助

這是為了防止意外鎖定自己的管理員權限。

#### 角色變更立即生效

- 角色變更會立即生效,使用者無需重新登入
- 系統會記錄所有角色變更到稽核日誌
- 使用者會在下次頁面載入時看到新的權限

---

## 身份驗證審核

### 身份驗證目的

高級會員可以提交身份驗證申請,以獲得:

- **無限制 API 配額** (不再受限於每月 10 次匯入)
- 在設定頁面顯示「已驗證」徽章

### 檢視驗證申請

1. 從管理員儀表板,點擊「身份驗證審核」
2. 您將看到所有待審核的申請列表:
   - 使用者電子郵件
   - 驗證方法
   - 提交日期
   - 目前狀態 (待審核/已核准/已拒絕)

### 審核身份驗證申請

#### 核准申請

1. 點擊待審核申請的「檢視」按鈕
2. 檢查驗證資訊:
   - 驗證方法 (電子郵件/身份證/電話等)
   - 提交日期
   - 使用者目前的 API 使用情況
3. 點擊「核准」按鈕
4. 系統會:
   - 將申請狀態變更為「已核准」
   - 設定使用者的 API 配額為「無限制」
   - 記錄審核動作到稽核日誌
   - **(未來實作)** 發送通知電子郵件給使用者

#### 拒絕申請

1. 點擊待審核申請的「檢視」按鈕
2. 點擊「拒絕」按鈕
3. 在「拒絕原因」文字框中輸入拒絕理由
4. 點擊「確認拒絕」
5. 系統會:
   - 將申請狀態變更為「已拒絕」
   - 保留拒絕原因供使用者查看
   - 記錄審核動作到稽核日誌
   - **(未來實作)** 發送通知電子郵件給使用者

#### 審核最佳實務

✓ **建議作法**:

- 仔細檢查驗證資訊的真實性
- 如有疑問,可以聯繫使用者確認
- 在拒絕時提供清楚的拒絕理由
- 定期檢查待審核申請 (建議每 24-48 小時)

⚠️ **注意事項**:

- 核准後無法直接撤銷,需手動設定 API 配額
- 拒絕後使用者可以重新提交申請
- 所有審核動作都會被記錄到稽核日誌

---

## 報表與分析

### 分析儀表板

管理員儀表板提供關鍵統計資訊:

#### 統計卡片

1. **總註冊使用者數** - 系統中所有使用者的總數
2. **已驗證使用者數** - 完成電子郵件驗證的使用者數
3. **各角色使用者分布** - 以圓餅圖顯示各角色的使用者數量
4. **API 配額使用統計** - 高級會員的 API 使用情況

#### 圖表

1. **新註冊趨勢** - 顯示過去 30 天的新註冊數量
2. **活躍使用者** - 按角色分類的活躍使用者統計
3. **API 使用量** - 顯示 API 匯入使用趨勢

### 匯出報表

#### 使用者列表 CSV 匯出

1. 前往「使用者管理」頁面
2. 套用所需的篩選條件 (可選)
3. 點擊「匯出 CSV」按鈕
4. 系統會下載包含以下欄位的 CSV 檔案:
   - 使用者 ID
   - 電子郵件
   - 角色
   - 電子郵件驗證狀態
   - 註冊日期
   - 最後登入時間

#### API 使用報表

1. 前往「報表與分析」頁面
2. 選擇日期範圍
3. 點擊「產生 API 使用報表」按鈕
4. 系統會顯示:
   - 總 API 呼叫次數
   - 各使用者的使用情況
   - 配額使用率

---

## 稽核日誌

### 稽核日誌目的

稽核日誌記錄所有重要的管理動作,包括:

- 使用者角色變更
- 身份驗證審核 (核准/拒絕)
- 管理員登入嘗試
- 關鍵設定變更

### 檢視稽核日誌

1. 從管理員儀表板,點擊「稽核日誌」
2. 您將看到所有稽核事件的列表:
   - 事件類型 (角色變更/身份驗證審核/登入)
   - 執行管理員
   - 目標使用者 (如適用)
   - 事件時間 (GMT+8)
   - 追蹤 ID (用於日誌關聯)

### 篩選稽核日誌

使用以下篩選條件縮小搜尋範圍:

- **動作類型**: 角色變更、身份驗證審核、登入
- **執行管理員**: 按管理員電子郵件篩選
- **目標使用者**: 按受影響的使用者篩選
- **日期範圍**: 選擇特定時間範圍

### 匯出稽核日誌

1. 套用所需的篩選條件
2. 點擊「匯出稽核日誌 CSV」按鈕
3. 系統會下載包含所有欄位的 CSV 檔案

### 稽核日誌最佳實務

✓ **定期檢查**:

- 每週檢查稽核日誌以發現異常活動
- 特別注意非預期的角色變更
- 追蹤重要事件的追蹤 ID 以進行深入調查

⚠️ **安全監控**:

- 如發現未經授權的管理動作,立即變更管理員密碼
- 定期匯出稽核日誌以進行離線歸檔
- 注意多次失敗的登入嘗試

---

## 安全性最佳實務

### 密碼安全

✓ **建議**:

- 使用強密碼 (至少 12 個字元,包含大小寫字母、數字、特殊字元)
- 定期變更密碼 (建議每 90 天)
- 不要與其他服務共用相同密碼
- 啟用密碼管理器以儲存複雜密碼

### Session 管理

⚠️ **重要**:

- 管理員 Session 逾時時間較短 (30 分鐘無活動)
- 離開電腦時請務必登出
- 不要在公用電腦上登入管理員帳號

### 權限管理

✓ **最佳實務**:

- 僅授予必要的角色權限
- 定期檢查使用者角色是否適當
- 移除不再需要管理權限的使用者
- 記錄所有角色變更的原因

### 身份驗證審核

✓ **審核標準**:

- 要求清楚的驗證證明
- 如有疑問,先拒絕並要求補充資訊
- 保持一致的審核標準
- 記錄審核決定的原因

### CSRF 保護

系統已自動啟用 CSRF 保護:

- 所有表單都包含 CSRF token
- 無法從外部網站提交管理表單
- 如看到 CSRF 錯誤,請重新整理頁面

### 速率限制

管理端點受速率限制保護:

- 登入: 每小時最多 5 次失敗嘗試
- API 端點: 每分鐘最多 60 次請求
- 如達到限制,請等待後重試

---

## 常見問題

### Q1: 我忘記管理員密碼了,該怎麼辦?

**A**: 使用密碼重設功能:

1. 前往登入頁面
2. 點擊「忘記密碼?」連結
3. 輸入管理員電子郵件 (themustbig@gmail.com)
4. 檢查電子郵件信箱中的密碼重設連結
5. 點擊連結並設定新密碼

### Q2: 為什麼我無法變更自己的角色?

**A**: 這是安全機制,防止管理員意外移除自己的管理權限。如需變更您的角色,請聯繫其他管理員協助。

### Q3: 角色變更需要多久生效?

**A**: 角色變更立即生效,使用者無需重新登入。他們會在下次頁面載入時看到新的權限。

### Q4: 如何撤銷已核准的身份驗證?

**A**: 目前系統不支援直接撤銷。您可以:

1. 前往「使用者管理」
2. 找到該使用者
3. 檢視其 API 配額設定
4. 手動將「無限制配額」改為「否」
5. 設定月配額為 10

**(注意: 未來版本將支援一鍵撤銷功能)**

### Q5: 使用者列表顯示很慢,該如何改善?

**A**: 針對大量使用者 (1000+),建議:

1. 使用篩選條件縮小範圍
2. 按角色篩選
3. 使用日期範圍限制
4. 如仍然緩慢,請聯繫系統管理員檢查資料庫效能

### Q6: 如何知道使用者是否有設定 YouTube API 金鑰?

**A**: 檢視使用者詳情頁面:

1. 前往「使用者管理」
2. 點擊使用者的「檢視」按鈕
3. 在「YouTube API 金鑰」區塊查看狀態:
   - ✓ 已設定
   - ✗ 未設定

### Q7: 稽核日誌會保留多久?

**A**: 稽核日誌永久保留,不會自動刪除。建議定期匯出重要日誌以進行離線歸檔。

### Q8: 如何新增其他管理員?

**A**: 將現有使用者提升為管理員:

1. 前往「使用者管理」
2. 找到要提升的使用者
3. 點擊「編輯」
4. 變更角色為「管理員」
5. 儲存變更

新管理員將立即獲得完整管理權限。

### Q9: CSV 匯出的資料是即時的嗎?

**A**: 是的,CSV 匯出會包含匯出時的最新資料。

### Q10: 如何查看特定使用者的活動歷史?

**A**: 使用稽核日誌:

1. 前往「稽核日誌」頁面
2. 在「目標使用者」篩選器中輸入使用者電子郵件
3. 點擊「篩選」
4. 您將看到所有與該使用者相關的稽核事件

---

## 技術支援

如遇到本指南未涵蓋的問題,請聯繫:

- **系統管理員**: themustbig@gmail.com
- **技術文件**: [CLAUDE.md](/CLAUDE.md)
- **開發者指南**: [docs/README.md](/docs/README.md)

---

**文件版本**: 1.0.0
**最後更新**: 2025-11-23
**系統版本**: DISINFO_SCANNER Member System v1.0.0
